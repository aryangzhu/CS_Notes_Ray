# 项目背景
项目中的注释和笔记很少，目前来看这是一个用来做活动的公共平台(Saas)
6.13 今天有了平台的账号，这是Saas平台中的一个小模块，活动量
# 技术框架
## Nacos配置中心
## 缓存-Redis
## Koltin
有时间再看
## MapStruct
主要的功能是在数据包装类之间进行转换
## 从启动类开始
1. @EnableDiscoveryClient 项目中用到了nacos,很显然是将服务注册到了nacos注册中心
2. @EnableCaching 开启缓存
3. @EnableFeignClient 使用了Fegin服务
Fegin是声明式的服务调用工具，将Ribbon(负载均衡)和hystrix(服务容灾)这种组件作用集成到一起
# 数据库
## 数据模型
### 活动表
### 活动服务范围表
### 用户表
## 业务
### 管理端
管理端主要是来管理活动(活动量和活动范围等)
### 学生用户端
学生端的功能比较复杂一些，主要针对学生用户，其中最重要的就是销售流程
### 活动量统计
1. 调用活动服务 activity
2. 统计服务 page1
获取已存在的计划用户id(分为管理员权限和非管理员权限)，拿到计划用户id和管理用户id的交集  
根据交集的结果在账户视图中获取数据，最后封装为报表实例对象，得到结果  
## 疑问点
1. 引入了Mybatis-plus，但是没有Generator类，后面可以在项目中添加一个配置按照自己电脑上来就可以
2. 还是Mabatis-plus，没有使用QueryWrapper或者说是LambdaQueryWrapper，单表查询更加便捷
3. 
# 测试与部署
## 测试
本地测试的话会有很多步骤难以实现，比如htmltopdf这个命令行，也可能是因为我偷懒，导致本地测试有问题
## 部署
现在使用的是jekins持续化集成，需要将deploy到远程由jekins构建 
公司的主要服务还是Manage和Student
# 问题 

友邦成长营  
大概是这样的，跟个人养老金专区一样，分几个板块：
1、友邦「致成长」  菁英成长陪伴服务一块，放的是1门课程  
2、学习专区   放的是1个微页面  
3、营销专区   放的是1个微页面（下分几个分类，点不同的分类有不同的内容，微页面上做了区分）
4、猜你想搜   放的是1个微页面（里边是课程）

另外，搭建到专区后，这些课程只能在这些专区里看，别的地方是看不到的，包括课程目录里，是找不到的  
```
        Environment env = SpringApplication.run(CourseApplication.class, args).getEnvironment();
        String port = env.getProperty("server.port", "8080");

        logger.info(
                "Access URLs:\n----------------------------------------------------------\n\t"
                        + "Local: \t\thttp://127.0.0.1:{}\n\t"
                        + "External: \thttp://{}:{}\n----------------------------------------------------------",
                port, InetAddress.getLocalHost().getHostAddress(), port);




spring.cloud.nacos.config.server-addr=mse-acb689f0-p.nacos-ans.mse.aliyuncs.com
spring.main.allow-circular-references=true

logging.level.root=info
logging.level.io.swagger.models.parameters.AbstractSerializableParameter=error
mybatis-plus.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl


#欧莱雅组织id
system.oly.orgrootId=1682270305336111104


server.port=35000
spring.application.name=system
ACTIVE=${spring.profiles.active}
spring.profiles.active=sit
# nacos
spring.cloud.nacos.config.shared-dataids=common-${spring.profiles.active}.properties
spring.cloud.nacos.config.namespace=${spring.profiles.active}
spring.cloud.nacos.config.prefix=${spring.application.name}
spring.cloud.nacos.config.file-extension=properties
spring.cloud.nacos.config.server-addr=192.168.1.61:8848
mybatis-plus.global-config.logic-not-delete-value=0
mybatis-plus.global-config.logic-delete-value=1
mybatis-plus.global-config.sql-injector=com.baomidou.mybatisplus.mapper.LogicSqlInjector
```

```
                <exclusion>
                    <groupId>org.icepdf.os</groupId>
                    <artifactId>icepdf-core</artifactId>
                </exclusion>
```


 "data": {
        "list": [
            {
                "id": "1681840978916474880",
                "name": "猜你想搜",
                "pensionChildModelList": [
                    {
                        "id": "1681841910760800256",
                        "name": ""
                    }
                ]
            },
            {
                "id": "1681840850067456000",
                "name": "营销专区",
                "pensionChildModelList": [
                    {
                        "id": "1681842615085105152",
                        "name": "热门"
                    },
                    {
                        "id": "1681842615609393154",
                        "name": "产品"
                    }
                ]
            },
            {
                "id": "1681841237692448768",
                "name": "大咖直播",
                "pensionChildModelList": [
                    {
                        "id": "",
                        "name": ""
                    }
                ]
            },
            {
                "id": "1681840900646567936",
                "name": "学习专区",
                "pensionChildModelList": [
                    {
                        "id": "1681842257696849920",
                        "name": "热门"
                    },
                    {
                        "id": "1681842257948508162",
                        "name": "产品"
                    }
                ]
            }
        ]
    }


        Date start1=null;
        Date end1=null;
        SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd");
        if(ObjectUtils.isEmpty(start)){
            start1=DateUtil.getFirstDayOfMonth(new Date());
        }else{
            start1= sdf.parse(start);
//            start1= DateUtil.parse(start,"YYYY-MM-dd");
        }
        if(ObjectUtils.isEmpty(end)){
            end1=new Date();
        }else{
            end1=sdf.parse(end);
//            end1= DateUtil.parse(end,"YYYY-MM-dd");
        }
        Map<String,Object> param=new HashMap<>();
        param.put("start",start1);
        param.put("end",end1);
        sunCodeLoginExport.export1(param,response);

1067032399575969792

{
  "name": "测试新的语音机器人",
  "logoUrl": "https://cloud-wmy.oss-cn-shanghai.aliyuncs.com/practice/logo/practice_logo.png",
  "description": "的顶顶顶顶顶的顶顶顶顶顶",
  "useType": 10,
  "keyWord": "",
  "robotParams": "{\"name\":\"x4_chaoge\"}",
  "robotId": "6",
  "robotAliasName": "是超哥",
  "robotPicUrl": "https://fulan-test.oss-cn-hangzhou.aliyuncs.com/test/rc-upload-1688552585406-5.jpeg",
  "practiceStartAt": 1688466189000,
  "practiceEndAt": 1693477389000,
  "classifyIds": [
    1696694845991190528
  ],
  "orderNum": 999,
}



	/**
	 * 校验文件路径中是否有目录穿越
	 * @param filePath
	 * @return
	 */
	public static Boolean checkPathPass(String filePath){
		if(StringUtils.isNotBlank(filePath)){
			boolean ret = filePath.contains("..") || filePath.contains("../") || filePath.startsWith(".") || filePath.contains("~");
			if(ret){
				return false;
			}else{
				return true;
			}
		}
		return true;
	}


http://api.polyv.net/live/v2/channels/
https://api.polyv.net/live/v2/channels/


{"viewerName":"username","viewerId":"e6563d65b0","viewerIp":"127.0.0.1","sign":"127F28FB723BC12334208FEA33EA8D1B","videoId":"e6563d65b0f3a2544c00cc2b5e23062b_e","extraParams":"-631859214","userId":"e6563d65b0","ts":"1694168136902"}

viewerName=username&
viewerId=e6563d65b0&
viewerIp=127.0.0.1&
sign=127F28FB723BC12334208FEA33EA8D1B&
videoId=e6563d65b0f3a2544c00cc2b5e23062b_e&
extraParams=-631859214&
userId=e6563d65b0&
ts=1694168136902

6-1703687861506928640-107-joinforces-0
1703687861506928640